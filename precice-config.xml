<?xml version="1.0"?>

<precice-configuration>

    <log>
	<sink type="stream" output="stdout" filter="%Severity% > debug" enabled="true"/>
    </log>
  
  <solver-interface dimensions="2">
    
    <data:scalar name="value"/>
    <data:scalar name="flux"/>

    <mesh name="core_read">
       <use-data name="flux"/>
    </mesh>

    <mesh name="core_write">
       <use-data name="value"/>
    </mesh>

    <mesh name="edge_read">
       <use-data name="value"/>
    </mesh>

    <mesh name="edge_write">
       <use-data name="flux"/>
    </mesh>
    
    <participant name="Core">
      <use-mesh name="core_read" provide="yes"/>
      <use-mesh name="core_write" provide="yes"/>
      <use-mesh name="edge_write" from="Edge"/>
      <write-data name="value" mesh="core_write"/>
      <read-data name="flux" mesh="core_read"/>
      <!--mapping:rbf-compact-tps-c2 direction="read" from="edge_write" to="core_read" constraint="consistent" support-radius="0.04"/-->
      <mapping:rbf-thin-plate-splines direction="read" from="edge_write" to="core_read" constraint="consistent" use-qr-decomposition="1"/>
      <export:vtk directory="vtk-output" every-n-time-windows="2"/>
    </participant>
    
    <participant name="Edge">		
      <use-mesh name="edge_read" provide="yes"/>
      <use-mesh name="edge_write" provide="yes"/>
      <use-mesh name="core_write" from="Core"/>
      <read-data name="value" mesh="edge_read"/>
      <write-data name="flux" mesh="edge_write"/>
      <!--mapping:rbf-compact-tps-c2 direction="read" from="core_write" to="edge_read" constraint="consistent" support-radius="0.04"/-->
      <mapping:rbf-thin-plate-splines direction="read" from="core_write" to="edge_read" constraint="consistent" use-qr-decomposition="1"/>
      <export:vtk directory="vtk-output" every-n-time-windows="2"/>
    </participant>

    <m2n:sockets from="Core" to="Edge" network="ib0"/>

    <coupling-scheme:parallel-explicit>
       <participants first="Core" second="Edge"/>
       <max-time value="4.0E-6"/>
       <time-window-size value="4.0e-6"/>
       <exchange data="value" mesh="core_write" from="Core" to="Edge" initialize="yes"/>
       <exchange data="flux" mesh="edge_write" from="Edge" to="Core" initialize="yes"/>
    </coupling-scheme:parallel-explicit>

  </solver-interface>
</precice-configuration>
